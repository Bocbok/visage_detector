<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        SY32 - Analyse et synthèse d’images - Détection de visages - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="position: relative;"><h1 id="SY32---Analyse-et-synthèse-d’images---Détection-de-visages"><a class="anchor hidden-xs" href="#SY32---Analyse-et-synthèse-d’images---Détection-de-visages" title="SY32---Analyse-et-synthèse-d’images---Détection-de-visages"><span class="octicon octicon-link"></span></a>SY32 - Analyse et synthèse d’images - Détection de visages</h1><h1 id="Introduction"><a class="anchor hidden-xs" href="#Introduction" title="Introduction"><span class="octicon octicon-link"></span></a>Introduction</h1><p>Le but de ce projet est de développer un modèle capable de détecter avec précision un ou plusieurs visages dans une image. Après avoir détaillé mes choix d’implémentation, je présenterai ma démarche d’entraînement du modèle pour enfin présenter mes résultats et conclusions.</p><h1 id="Choix-d’implémentation"><a class="anchor hidden-xs" href="#Choix-d’implémentation" title="Choix-d’implémentation"><span class="octicon octicon-link"></span></a>Choix d’implémentation</h1><h2 id="Résumé"><a class="anchor hidden-xs" href="#Résumé" title="Résumé"><span class="octicon octicon-link"></span></a>Résumé</h2><p>J’ai choisi d’utiliser un réseau de neurones à convolution en utilisant l’architecture <em>VGG16</em> car elle présente de bon résultats sur le dataset <em>cifar-10</em> qui est un dataset d’images en 32x32.</p><p>Mon idée est qu’au lieu de prendre les boîtes labels comme exemple positifs et générer des exemples négatifs aléatoires, je vais générer tous les exemples possiblements vus par une <em>sliding window</em> ayant certains paramètres.</p><p>Ainsi le modèle est directement entrainé a voird es exemples venant d’une sliding window.</p><p>Il m’a donc d’abord fallu déterminer les paramètres de <em>sliding window</em> optimaux afin de réaliser mon découpage d’images.</p><p>J’ai également fait le choix de faire varier la taille de la fenêtre car je vais de toute façon tout redimensionner en 32x32 qui sera la taille d’entrée de mon modèle.</p><p>Par la suite je vais entraîner le CNN sur les exemples précedemments générés en mesurant le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-407-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-2117" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2118" class="mjx-mrow"><span id="MJXc-Node-2119" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2121" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-407">f_1</script></span> qui servira de mesures proxy pour mes prédictions. En effet j’assume le fait que maximiser le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-408-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-2122" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2123" class="mjx-mrow"><span id="MJXc-Node-2124" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2126" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-408">f_1</script></span> lors de mon entraînement le maximisera lors de mes détections.</p><p>Enfin grâce au seuil maximisant le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-523-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-2697" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2698" class="mjx-mrow"><span id="MJXc-Node-2699" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2700" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2701" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-523">f_1</script></span> pour un modèle donné je peux appliquer mon algorithme de <em>sliding window</em> à mon ensemble de validation pour mesurer sa performances et modifiers quelques hyper paramètres avant de faire un prédiction sur l’ensemble de test.</p><h2 id="Choix-du-modèle"><a class="anchor hidden-xs" href="#Choix-du-modèle" title="Choix-du-modèle"><span class="octicon octicon-link"></span></a>Choix du modèle</h2><p>J’ai dans un premier temps opté pour l’implémentation rapide d’un modèle de boosting en utilisant la librairie LightGBM. L’avantage de ce type de modèle et de cette librairie et qu’il est très facile et rapide de développer et entrainer un modèle. Cette démarche m’a permis d’avoir une baseline et de cerner le problème et pour en définir la complexité.</p><p>Pour l’entraînement du modèle de boosting j’ai simplement extrait les visages des images en utilisant les coordonnées des boîtes labels puis j’ai redimmensionné l’image dans un format 64x64. Les prédictions de mon modèle en utilisant de la cross validation étaient concluantes mais en pratique les résultats n’étaients pas bons :</p><p><img src="https://i.imgur.com/SUeb5kr.png" alt=""></p><p>Détection décalée ou détection de mains / doigts.</p><p>Constatant les faibles performances de ce modèle deux choix s’offrent à moi : Faire un second entraînement avec ce modèle ou changer de modèle.</p><p>J’ai choisi de changer de modèle et de me diriger vers un réseau de neurones à convolution. En effet ces dernières années, les réseaux de neurones à convolution ce sont imposés comme le meilleur moyen de détection et de classification d’image. Le développement du premier modèle de boosting a permis d’avoir une base pour comparer mes performances et de commencer à développer les algorithmes comme la <em>sliding window</em> que j’utiliserai par la suite.</p><h2 id="Plan-d’action"><a class="anchor hidden-xs" href="#Plan-d’action" title="Plan-d’action"><span class="octicon octicon-link"></span></a>Plan d’action</h2><ul>
<li>Analyser les données</li>
<li>Déterminer le pas et la taille de fenêtre optimale</li>
<li>Créer le Dataset</li>
<li>Entraîner un classifieur</li>
<li>Analyser les performances du classifieur</li>
<li>Appliquer l’algorithme de <em>sliding window</em> sur les images</li>
<li>Mesurer les performances de détection</li>
</ul><h2 id="Analyse-des-données"><a class="anchor hidden-xs" href="#Analyse-des-données" title="Analyse-des-données"><span class="octicon octicon-link"></span></a>Analyse des données</h2><p>Pour bien démarrer l’important est d’analyser et d’explorer nos données d’entraînement. On va notamment s’intéresser aux labels que l’ont doit déterminer :<br>
<img src="https://i.imgur.com/Mf7MwSN.png" alt=""></p><p>On peut déduire qu’en moyenne, la boîte label qui englobe le visage fait <em>167</em> pixels de hauteur pour <em>110</em> pixels de large.</p><p>On peut aussi utiliser des graphiques pour analyser la distribution des boîtes labels.</p><p><em>Histogramme de la largeur des boîtes:</em><br>
<img src="https://i.imgur.com/4OnSXgg.png" alt=""></p><p><em>Histogramme de la hauteur des boîtes:</em><br>
<img src="https://i.imgur.com/y7QyI8t.png" alt=""></p><p><em>Histogramme du ratio largeur/hauteur des boîtes:</em><br>
<img src="https://i.imgur.com/D4330vd.png" alt=""></p><p>On peut voir que le ratio largeur/hauteur est majoritairement compris entre <em>0.55</em> et <em>0.75</em>. On va donc essayer de conserver ce ratio lors de la définition de la taille de nos fenêtres. Ce ratio peut s’expliquer par la forme d’un visage qui est en général plus long que large. Les boîtes sont donc en général des recangles.</p><h2 id="Déterminer-les-paramètres-optimaux-de-l’algorithme-sliding-window-et-création-du-dataset"><a class="anchor hidden-xs" href="#Déterminer-les-paramètres-optimaux-de-l’algorithme-sliding-window-et-création-du-dataset" title="Déterminer-les-paramètres-optimaux-de-l’algorithme-sliding-window-et-création-du-dataset"><span class="octicon octicon-link"></span></a>Déterminer les paramètres optimaux de l’algorithme <em>sliding window</em> et création du dataset</h2><p>J’ai choisi d’utiliser une autre manière d’entraîner mon modèle que celle suggérée en cours. En effet en cours on nous suggère de prendre les boîtes labels comme exemple positif et de générer des exemples négatifs aléatoires. Puis ensuite de refaire un entraînement en incluant les faux positifs dans notres dataset d’entraînement. Cette manière de faire présente quelques inconvénients : Comment choisir les fenêtres négatives ? Combien de fenêtres négatives faut-il générer ? Quelle proportion positif / negatif faut-il ?</p><p>Il n’est pas facile de répondre à ces questions, c’est pour cela que j’ai décidé d’utiliser une autre méthode : Puisque nous allons utiliser un algorithme de <em>sliding window</em> sur nos images, nous allons générer tous les découpages possiblements vus par notre algorithme et entraîner notre modèle dessus. Ainsi notre modèle aura conscience de la proportion visage / non visage que l’on aura en production et sera entraîné à reconnaître des visages alors que la fenêtre n’est pas parfaitement centrée sur celui-ci.</p><h3 id="Algorithme-sliding-window"><a class="anchor hidden-xs" href="#Algorithme-sliding-window" title="Algorithme-sliding-window"><span class="octicon octicon-link"></span></a>Algorithme <em>sliding window</em></h3><p>Avant de se lancer dans l’entraînement d’un modèle il vaut mieux d’abord s’attarder sur la manière avec laquelle nous allons effectuer nos prédictions.</p><p>Nous allons donc utiliser un algorithme de <em>sliding window</em> afin d’extraire des images avec un certain pas et certaines tailles de fenêtre.</p><p>Il y a 2 manières d’implémenter cet algorithme :</p><ol>
<li>Choisir une taille de fenêtre fixe et faire varier l’échelle de l’image pour simuler des tailles de fenêtre différentes.</li>
<li>Fixer l’échelle de l’image et faire varier la taille de la fenêtre qui va la parcourir.</li>
</ol><p>L’implémentation d’un classifieur implique que l’image d’entrée doit toujours avoir le même format ce qui naturellement nous dirige vers la méthode 1.</p><p>Or avec les outils de redimensionnement d’image de la librairie Pillow on peut aisément appliquer la méthode 2. En effet il suffit de redimensionner l’image capturée par la fenêtre avant de faire la prédiction. Utiliser cette méthode a un avantage qui est qu’au lieu de manipuler et faire varier des échelles on va faire varier une taille de fenêtre ce qui est un peu plus interprétable qu’une échelle.</p><p>De plus grâce à notre étude de la répartition des boîtes on peut facilement définir des taille de fenêtre qui couvrent le plus large spectre possible de hauteurs et largeurs.</p><h3 id="Déterminer-les-paramètres-optimaux"><a class="anchor hidden-xs" href="#Déterminer-les-paramètres-optimaux" title="Déterminer-les-paramètres-optimaux"><span class="octicon octicon-link"></span></a>Déterminer les paramètres optimaux</h3><p>Afin de déterminer les paramètres optimaux de <em>pas</em> et <em>taille</em> de la fenêtre on va simuler tous les découpages possiblement générés par un jeu de paramètres puis mesurer leur performance.</p><p>En effet on suppose que l’on détient déjà un modèle parfait qui détecte 100% des visages. En fixant une ou plusieurs tailles de fenêtre et un ou plusieurs <em>stride</em> (pas de déplacement de la fenêtre) on peut simuler toutes les fenêtres (ou boîtes) qui vont être générées par ce découpage.</p><p>Pour déterminer la qualité de notre découpage on peut ensuite mesurer dans celui-ci, combien de nos boîtes labels sont suffisament recouvertes par nos fenêtres générées.</p><p>On peut ainsi déterminer un découpage optimal ayant le meilleur compromis entre précision maximale et nombre de fenêtres générées.</p><p>On peut évidemment avoir une précision maximale de 100% en générant plus de 300 000 images mais le temps pour la prédiction serait extremement long.</p><p>En utilisant la technologie du multiprocessing on peut tester un grand nombre de paramètres différents en un temps réduit et ainsi déterminer la combinaison optimale de taille de fenêtre et stride.</p><p><em>Exemple de résultat d’un jeu de paramètres</em><br>
ws pour ‘window size’<br>
acc pour ‘accuracy’ représente la précision maximale obtenue par cette taille de fenêtre<br>
mean pour ‘moyenne’ nombre moyen de boîtes trouvées par visage<br>
<img src="https://i.imgur.com/DfCzojd.png" alt=""></p><p>La combinaison retenue est la suivant :</p><ul>
<li>Taille de fenêtres :
<ul>
<li>(100, 85)</li>
<li>(200, 100)</li>
<li>(250, 212)</li>
</ul>
</li>
<li>Stride : 35</li>
</ul><p>Le stride n’est pas définit en nombre de pixel mais en pourcentage de la taille de la fenêtre. C’est à dire qu’a chaque itération la fenêtre va se déplacer de 35% de sa largeur ou hauteur. Cela permet de réduire le nombre d’images générées par des fenêtres qui se superposeraient trop et d’harmoniser le déplacement de la fenêtre qui s’adapte à la taille de la fenêtre.</p><p>La taille des fenêtres retenues est varié et couvre la majeure partie du spectre des tailles défini dans l’analyse des données. En guardant ces tailles d’images et en faisant varier le stride on obtient les résultats suivants :</p><table>
<thead>
<tr>
<th>Stride</th>
<th>Précision max</th>
<th>Nombre moyen de fenêtre par visage</th>
<th>nombre d’image total</th>
</tr>
</thead>
<tbody>
<tr>
<td>30</td>
<td>0.936</td>
<td>2.023</td>
<td>201 673</td>
</tr>
<tr>
<td>35</td>
<td>0.900</td>
<td>1.565</td>
<td>153 061</td>
</tr>
<tr>
<td>40</td>
<td>0.807</td>
<td>1.311</td>
<td>122 755</td>
</tr>
</tbody>
</table><p>Le découpage avec un stride de 35 semble le plus raisonnable niveau précision max / nombre d’image. De plus on pourra facilement faire varier le stride plus tard lors de la validation de notre modèle.</p><h3 id="Création-du-dataset"><a class="anchor hidden-xs" href="#Création-du-dataset" title="Création-du-dataset"><span class="octicon octicon-link"></span></a>Création du dataset</h3><p>Maintenant que l’on a défini nos paramètres optimaux, on peut créer notre dataset. Pour cela on va appliquer le découpage que l’on a déterminé précédemment.</p><p>Pour chaque image du dataset, On calcule les coordonnées de toutes les boîtes qui pourraient être vues par notre algoritme en fonction de la taille d’image et le stride défini. Une fois ces coordonnées déterminées, on calcule les IoU (Intersection over Union) entre nos boîtes générées et nos boîtes labels afin de déterminer quelles boîtes sont positives ou négatives. Ainsi les boîtes générées ayant une aire de recouvrement suffisante avec une boîte label auront la classe <em>1</em> et seront considérées comme un visage; les autres boîtes auront la classe <em>0</em> donc non visage.</p><p>Le seuil d’IoU attendu pour être considéré comme un vrai positif lors de la prédiction finale est de 0.5. Cependant, pour éviter les confusions, j’ai décidé pour l’entrainement du modèle qu’un recouvrement de 0.4 était suffisant pour qu’une boîte soit considéré comme contenant un visage.</p><p>De plus cela permet au modèle d’avoir plus de données ayant la classe visage. Avoir une tolérance de 0.4 d’IoU permet d’être plus permisif au niveau des détections, on appliquera plus tard un algoritme pour fusionner les multiples boîtes détectées, ce qui nous permet de conserver des boîtes un peu décalées ou un peu trop petite ou trop grande.</p><p>On peut enfin séparer notre dataset en 2 jeux de données : Un jeu de donnée d’entrainement et un de validation. Il faut veiller à ce que les images découpées correspondant à la même image soient ensemble dans le même set sinon ce serait tricher et le modèle pourrait reconnaître les images. En faisant cela on conserve aussi la proportion d’image contenant des visages dans chaque dataset. Ainsi les images 1 à 800 appartiennent au dataset d’entraînement et les images 801 à 1000 au dataset de validation.</p><h2 id="Architecture-du-CNN"><a class="anchor hidden-xs" href="#Architecture-du-CNN" title="Architecture-du-CNN"><span class="octicon octicon-link"></span></a>Architecture du CNN</h2><p>Pour l’architecture du CNN j’ai choisi d’utiliser une architecture VGG16 telle que décrite ici <a href="https://arxiv.org/abs/1409.1556" target="_blank" rel="noopener">[1]</a></p><p><img src="https://i.imgur.com/Rdzxkyb.png" alt=""></p><p>L’architecture VGG16 étant de base conçue pour de grandes images <em>(224, 224, 3)</em> j’ai tout de même choisi d’utiliser cette architecture car elle présente de bons résultats <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7486599&amp;tag=1" target="_blank" rel="noopener">[2]</a> sur le dataset CIFAR-10 qui est un dataset d’images en taille <em>(32, 32, 3)</em> avec 10 classes différentes. Cette architecture paraît donc appropriée à notre cas d’utilisation et c’est celle que je vais implémenter. Pour adapter l’architecture à une classification binaire il suffit de modifier la dernière couche qui est un <em>softmax</em> en <em>sigmoid</em> afin d’avoir une seule sortie correspondant à la probabilité que l’image soit un visage</p><h2 id="Entraînement-du-modèle"><a class="anchor hidden-xs" href="#Entraînement-du-modèle" title="Entraînement-du-modèle"><span class="octicon octicon-link"></span></a>Entraînement du modèle</h2><p>Pour entraîner le modèle j’ai utilisé les <code>ImageDataGenerator</code> de l’API Keras qui permettent de modifier aléatoirement les images à chaque batch. Ainsi, on peut par exemple inverser horizontalement l’image ou appliquer une légère rotation. Cela ne dénature pas l’image, un visage reste un visage, mais pour notre modèle c’est une image complétement nouvelle qu’il n’a jamais vu. Cela permet de prévenir l’overfitting aux données d’apprentissage, c’est à dire que le modèle apprend à reconnaître les images d’entraînement et ne parviens pas à généraliser à des images qu’il n’a jamais vu.</p><p>Il est important d’effectuer ces transformations à la volée afin de ne pas perturber la distribution des classes d’images. En effet on pourrait artificiellement augmenter le nombre d’images positives afin d’avoir un dataset plus équilibré mais notre modèle s’attendrait alors une fois en production à voir plus de visages que ce qui est vraiment présent et ce n’est pas ce que l’ont veut.</p><p>Attention cependant, lors du test en validation il ne faut pas appliquer ces transformations aléatoires sinon on ne peut pas comparer nos performances entre elles. En effet notre modèle peut être moins performant car nos transformations aléatoires ont généré un dataset plus compliqué. Il est donc important de toujours utiliser le même dataset de validation.</p><h3 id="Gestion-du-déséquilibre-des-données"><a class="anchor hidden-xs" href="#Gestion-du-déséquilibre-des-données" title="Gestion-du-déséquilibre-des-données"><span class="octicon octicon-link"></span></a>Gestion du déséquilibre des données</h3><p>L’une des problématique d’avoir un jeu de données tant déséquilibré est que notre modèle ne voit pas suffisament de visages et qu’en prédisant toujours la classe <em>0</em> il aura quasi 95% de précision.</p><p>Pour contrer ce déséquilibre on va demander à notre modèle de donner plus d’attention aux exemples positifs que négatifs. Dans ce but nous allons défénir des poids que nous allons appliquer à chacune des classes grâce à la formule suivante :</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-1-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; min-width: 11.769em; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><msub><mi>n</mi><mn>0</mn></msub><mspace linebreak=&quot;newline&quot; /><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mi>&amp;#x03B1;</mi><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mn>0</mn></msub><mo>+</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><msub><mi>n</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-1" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -1.492em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-3" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-6" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-7" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-8" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span><span id="MJXc-Node-9" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-10" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-11" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-12" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-13" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-14" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-15" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-16" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-17" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-18" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-19" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-20" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-21" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-22" class="mjx-texatom"><span id="MJXc-Node-23" class="mjx-mrow"><span id="MJXc-Node-24" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">/</span></span></span></span><span id="MJXc-Node-25" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-26" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-27" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-28" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-29" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-30" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-31" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-32" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-33" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-34" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-35" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-36" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-37" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-38" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-39" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-40" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-41" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-42" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-43" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-44" class="mjx-texatom"><span id="MJXc-Node-45" class="mjx-mrow"><span id="MJXc-Node-46" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">/</span></span></span></span><span id="MJXc-Node-47" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-48" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-49" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msub><mi>n</mi><mn>0</mn></msub><mspace linebreak="newline"></mspace><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mi>α</mi><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>n</mi><mn>0</mn></msub><mo>+</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msub><mi>n</mi><mn>1</mn></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-1">
w_0 = (1 - \alpha) \cdot (n_1 + n_0) / n_0 \\
w_1 = \alpha \cdot (n_0 + n_1) / n_1
</script></span></p><p>avec <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>" role="presentation"><span id="MJXc-Node-50" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-51" class="mjx-mrow"><span id="MJXc-Node-52" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\alpha</script></span> un coefficient représentant l’importance que l’on souhaite donner à la classe <em>1</em> et que l’on peut faire usuellement varier entre <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.2</mn></math>" role="presentation"><span id="MJXc-Node-53" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-54" class="mjx-mrow"><span id="MJXc-Node-55" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.2</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.2</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">0.2</script></span> et <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.5</mn></math>" role="presentation"><span id="MJXc-Node-56" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-57" class="mjx-mrow"><span id="MJXc-Node-58" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.5</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.5</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">0.5</script></span>. Avec un <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>" role="presentation"><span id="MJXc-Node-59" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-60" class="mjx-mrow"><span id="MJXc-Node-61" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">\alpha</script></span> de <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.5</mn></math>" role="presentation"><span id="MJXc-Node-62" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-63" class="mjx-mrow"><span id="MJXc-Node-64" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.5</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.5</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">0.5</script></span> on a la somme des poids de la classe <em>1</em> qui est égale à la somme des poids de la classe <em>0</em> et la somme des poids totaux qui reste égale à la somme des poids normaux. On peut résumer les conditions par ce système d’équation pour:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-7-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; min-width: 16.614em; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B1;</mi><mo>&amp;#x22C5;</mo><msub><mi>n</mi><mn>1</mn></msub><mo>&amp;#x22C5;</mo><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><msub><mi>n</mi><mn>0</mn></msub><mo>&amp;#x22C5;</mo><msub><mi>w</mi><mn>0</mn></msub><mspace linebreak=&quot;newline&quot; /><mi>&amp;#x03B1;</mi><mo>&amp;#x22C5;</mo><msub><mi>n</mi><mn>1</mn></msub><mo>&amp;#x22C5;</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><msub><mi>n</mi><mn>0</mn></msub><mo>&amp;#x22C5;</mo><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><msub><mi>n</mi><mn>0</mn></msub><mo>+</mo><msub><mi>n</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-65" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-66" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -1.492em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-67" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-68" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-69" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-70" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-71" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-72" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-73" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-74" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-75" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-76" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-77" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-78" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span><span id="MJXc-Node-79" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-80" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-81" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-82" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-83" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-84" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-85" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-86" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-87" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-88" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-89" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-90" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-91" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-92" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-93" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-94" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-95" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-96" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-97" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-98" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-99" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-100" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-101" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-102" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span><span id="MJXc-Node-103" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-104" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-105" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-106" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-107" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-109" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-110" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-111" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-113" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-114" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-115" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-117" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span><span id="MJXc-Node-118" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-119" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-121" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>α</mi><mo>⋅</mo><msub><mi>n</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>n</mi><mn>0</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>0</mn></msub><mspace linebreak="newline"></mspace><mi>α</mi><mo>⋅</mo><msub><mi>n</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>n</mi><mn>0</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>0</mn></msub><mo>=</mo><msub><mi>n</mi><mn>0</mn></msub><mo>+</mo><msub><mi>n</mi><mn>1</mn></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-7">
\alpha \cdot n_1 \cdot w_1 = (1-\alpha) \cdot n_0 \cdot w_0 \\
\alpha \cdot n_1 \cdot w_1 + (1-\alpha) \cdot n_0 \cdot w_0 = n_0 + n_1
</script></span></p><p>On remarque que lorsque <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo>=</mo><mn>0.5</mn></math>" role="presentation"><span id="MJXc-Node-122" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-123" class="mjx-mrow"><span id="MJXc-Node-124" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-125" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-126" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.5</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>=</mo><mn>0.5</mn></math></span></span><script type="math/tex" id="MathJax-Element-8">\alpha = 0.5</script></span> on a la classe <em>1</em> qui aura la même importance que la classe <em>0</em> même si elle est sous représenté car elle possède la moitié des poids totaux.</p><p>Une fois ces poids calculés on va faire apprendre notre modèle et l’optimiser en utilisant la fonction d’erreur <em>Weighted Binary Cross Entropy</em> :</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>H</mi><mi>p</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x22C5;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><msub><mi>w</mi><mn>0</mn></msub></math>" role="presentation"><span id="MJXc-Node-127" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-128" class="mjx-mrow"><span id="MJXc-Node-129" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.057em;"><span id="MJXc-Node-130" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.057em;">H</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-131" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span><span id="MJXc-Node-132" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-133" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-134" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-135" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-136" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-137" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.088em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.088em; top: -1.368em;"><span id="MJXc-Node-138" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span><span class="mjx-denominator" style="width: 1.088em; bottom: -0.716em;"><span id="MJXc-Node-139" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.085em;">N</span></span></span><span style="border-bottom: 1.3px solid; top: -0.285em; width: 1.088em;" class="mjx-line"></span></span><span style="height: 2.083em; vertical-align: -0.716em;" class="mjx-vsize"></span></span><span id="MJXc-Node-140" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-stack"><span class="mjx-over" style="font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;"><span id="MJXc-Node-147" class="mjx-texatom" style=""><span id="MJXc-Node-148" class="mjx-mrow"><span id="MJXc-Node-149" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.085em;">N</span></span></span></span></span><span class="mjx-op"><span id="MJXc-Node-141" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.722em; padding-bottom: 0.722em;">∑</span></span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;"><span id="MJXc-Node-142" class="mjx-texatom" style=""><span id="MJXc-Node-143" class="mjx-mrow"><span id="MJXc-Node-144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-145" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-146" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-150" class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-152" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span><span id="MJXc-Node-153" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-154" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.556em;">log</span></span><span id="MJXc-Node-155" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-156" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-157" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-158" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-159" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-160" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-161" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span><span id="MJXc-Node-162" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-163" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-164" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-165" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-167" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-168" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-169" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-170" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span><span id="MJXc-Node-171" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-172" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-173" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-174" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span><span id="MJXc-Node-175" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-176" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-177" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.556em;">log</span></span><span id="MJXc-Node-178" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-179" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-180" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span><span id="MJXc-Node-181" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-182" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-183" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-184" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-185" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-186" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span><span id="MJXc-Node-187" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-188" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-189" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-190" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-191" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-192" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>H</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>w</mi><mn>0</mn></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-9">
H_p(q) = -\frac{1}{N}\sum_{i=1}^{N}y_i \cdot\log(p(y_i)) \cdot w_1+(1-y_i)\cdot\log(1 - p(y_i)) \cdot w_0
</script></span></p><p>Avec <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>i</mi></msub></math>" role="presentation"><span id="MJXc-Node-193" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-194" class="mjx-mrow"><span id="MJXc-Node-195" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-196" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-197" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">y_i</script></span> le label <em>0</em> ou <em>1</em> et <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><span id="MJXc-Node-198" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-199" class="mjx-mrow"><span id="MJXc-Node-200" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-201" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-202" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-203" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.501em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-204" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-205" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">p(y_1)</script></span> la probabilité calculée par le modèle.</p><h3 id="Mesures-des-performances"><a class="anchor hidden-xs" href="#Mesures-des-performances" title="Mesures-des-performances"><span class="octicon octicon-link"></span></a>Mesures des performances</h3><p>Pour mesurer les performances de notre modèle on a vu qu’il ne servait à rien de regarder la précision seule car un modèle prédisant toujours la classe <em>0</em> aura presque 100% de précision au vu du rapport visage/non visage de notre dataset.</p><p>On va donc plutôt calculer à chaque époque la valeur du score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-625-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-3215" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3216" class="mjx-mrow"><span id="MJXc-Node-3217" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-3218" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3219" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-625">f_1</script></span> optimal obtenue par notre modèle sur l’ensemble de validation. Pour calculer le score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-626-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-3220" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3221" class="mjx-mrow"><span id="MJXc-Node-3222" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-3223" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-3224" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-626">f_1</script></span>, on doit pouvoir faire la distinction entre vrais positifs, faux positifs et faux négatifs. Nous devons donc déterminer un seuil à partir duquel une prédiction est considérée comme positive, ce seuil permettant d’obtenir le meilleur score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-627-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mn>1</mn></math>" role="presentation"><span id="MJXc-Node-3225" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-3226" class="mjx-mrow"><span id="MJXc-Node-3227" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-3228" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-627">f1</script></span> pour ce modèle. Pour cela on trie nos prédictions par score et on calcule la précision et le rappel en utilisant chaque prédiction comme nouveau seuil:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display"><span id="MathJax-Element-738-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; min-width: 18.211em; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi></mrow><mo>=</mo><mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>V</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mtext>&amp;#xA0;</mtext><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>V</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mtext>&amp;#xA0;</mtext><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>x</mi><mtext>&amp;#xA0;</mtext><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mrow></mfrac><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>R</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow><mo>=</mo><mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>V</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mtext>&amp;#xA0;</mtext><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>V</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mtext>&amp;#xA0;</mtext><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>F</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>x</mi><mtext>&amp;#xA0;</mtext><mi mathvariant=&quot;normal&quot;>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE9;</mo></mrow><mi mathvariant=&quot;normal&quot;>g</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mrow></mfrac><mspace linebreak=&quot;newline&quot; /></math>" role="presentation"><span id="MJXc-Node-7500" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-7501" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.287em;"><span class="mjx-block" style="text-align: center;"><span class="mjx-box"><span id="MJXc-Node-7502" class="mjx-texatom"><span id="MJXc-Node-7503" class="mjx-mrow"><span id="MJXc-Node-7504" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7505" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7506" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-7507" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">c</span></span><span id="MJXc-Node-7508" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7509" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7510" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7511" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7512" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">n</span></span></span></span><span id="MJXc-Node-7513" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-7514" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 12.795em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 12.795em; top: -1.432em;"><span id="MJXc-Node-7515" class="mjx-texatom"><span id="MJXc-Node-7516" class="mjx-mrow"><span id="MJXc-Node-7517" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">V</span></span><span id="MJXc-Node-7518" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7519" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7520" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7521" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7522" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.274em; padding-bottom: 0.335em;">&nbsp;</span></span><span id="MJXc-Node-7523" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7524" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7525" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7526" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7527" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.335em;">t</span></span><span id="MJXc-Node-7528" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7529" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.335em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-7530" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span></span></span></span><span class="mjx-denominator" style="width: 12.795em; bottom: -0.932em;"><span id="MJXc-Node-7531" class="mjx-mrow"><span id="MJXc-Node-7532" class="mjx-texatom"><span id="MJXc-Node-7533" class="mjx-mrow"><span id="MJXc-Node-7534" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">V</span></span><span id="MJXc-Node-7535" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7536" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7537" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7538" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7539" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.274em; padding-bottom: 0.335em;">&nbsp;</span></span><span id="MJXc-Node-7540" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7541" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7542" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7543" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7544" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.335em;">t</span></span><span id="MJXc-Node-7545" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7546" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.335em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-7547" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span></span></span><span id="MJXc-Node-7548" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-7549" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-7550" class="mjx-mrow"><span id="MJXc-Node-7551" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">F</span></span><span id="MJXc-Node-7552" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7553" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">u</span></span><span id="MJXc-Node-7554" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">x</span></span><span id="MJXc-Node-7555" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.274em; padding-bottom: 0.335em;">&nbsp;</span></span><span id="MJXc-Node-7556" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7557" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7558" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7559" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7560" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.335em;">t</span></span><span id="MJXc-Node-7561" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7562" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.335em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-7563" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.285em; width: 12.795em;" class="mjx-line"></span></span><span style="height: 2.364em; vertical-align: -0.932em;" class="mjx-vsize"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-7564" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-7565" class="mjx-texatom"><span id="MJXc-Node-7566" class="mjx-mrow"><span id="MJXc-Node-7567" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">R</span></span><span id="MJXc-Node-7568" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7569" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7570" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7571" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-7572" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">l</span></span></span></span><span id="MJXc-Node-7573" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-7574" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 13.11em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 13.11em; top: -1.432em;"><span id="MJXc-Node-7575" class="mjx-texatom"><span id="MJXc-Node-7576" class="mjx-mrow"><span id="MJXc-Node-7577" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">V</span></span><span id="MJXc-Node-7578" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7579" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7580" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7581" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7582" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.274em; padding-bottom: 0.335em;">&nbsp;</span></span><span id="MJXc-Node-7583" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7584" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7585" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7586" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7587" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.335em;">t</span></span><span id="MJXc-Node-7588" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7589" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.335em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-7590" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span></span></span></span><span class="mjx-denominator" style="width: 13.11em; bottom: -1.039em;"><span id="MJXc-Node-7591" class="mjx-mrow"><span id="MJXc-Node-7592" class="mjx-texatom"><span id="MJXc-Node-7593" class="mjx-mrow"><span id="MJXc-Node-7594" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">V</span></span><span id="MJXc-Node-7595" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7596" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7597" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7598" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7599" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.274em; padding-bottom: 0.335em;">&nbsp;</span></span><span id="MJXc-Node-7600" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7601" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7602" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7603" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7604" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.335em;">t</span></span><span id="MJXc-Node-7605" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7606" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.335em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-7607" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span></span></span><span id="MJXc-Node-7608" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-7609" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-7610" class="mjx-mrow"><span id="MJXc-Node-7611" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">F</span></span><span id="MJXc-Node-7612" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7613" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">u</span></span><span id="MJXc-Node-7614" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">x</span></span><span id="MJXc-Node-7615" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.274em; padding-bottom: 0.335em;">&nbsp;</span></span><span id="MJXc-Node-7616" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">n</span></span><span id="MJXc-Node-7617" class="mjx-texatom"><span id="MJXc-Node-7618" class="mjx-mrow"><span id="MJXc-Node-7619" class="mjx-mo"><span class="mjx-char" style="padding-top: 0.556em; padding-bottom: 0.224em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.277em; width: 0.487em;">é</span></span></span></span></span><span id="MJXc-Node-7620" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">g</span></span><span id="MJXc-Node-7621" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7622" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.335em;">t</span></span><span id="MJXc-Node-7623" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7624" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.335em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-7625" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.285em; width: 13.11em;" class="mjx-line"></span></span><span style="height: 2.471em; vertical-align: -1.039em;" class="mjx-vsize"></span></span></span></span><span class="mjx-block" style="text-align: center; padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-7626" class="mjx-mspace" style="width: 0px; height: 0px;"></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo>=</mo><mfrac><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">V</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">s</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">V</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">s</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">F</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">x</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">s</mi></mrow></mrow></mfrac><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">R</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow><mo>=</mo><mfrac><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">V</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">s</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">V</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">s</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">F</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">x</mi><mtext>&nbsp;</mtext><mi mathvariant="normal">n</mi><mrow class="MJX-TeXAtom-ORD"><mo>é</mo></mrow><mi mathvariant="normal">g</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">s</mi></mrow></mrow></mfrac><mspace linebreak="newline"></mspace></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-738">
\mathrm{precision} = \frac{\mathrm{Vrais\ positifs}}{\mathrm{Vrais\ positifs} + \mathrm{Faux\ positifs}}\\
\mathrm{Rappel} =  \frac{\mathrm{Vrais\ positifs}}{\mathrm{Vrais\ positifs} + \mathrm{Faux\ négatifs}}\\
</script></span><br>
On calcule ensuite le score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-739-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7627" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7628" class="mjx-mrow"><span id="MJXc-Node-7629" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7630" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7631" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-739">f_1</script></span> pour chaque seuil et on trouve le plus performant :<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-740-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mo>&amp;#x22C5;</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-7632" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7633" class="mjx-mrow"><span id="MJXc-Node-7634" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7635" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7636" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-7637" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-7638" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span><span id="MJXc-Node-7639" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-7640" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 7.99em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 7.99em; top: -1.421em;"><span id="MJXc-Node-7641" class="mjx-mrow"><span id="MJXc-Node-7642" class="mjx-texatom"><span id="MJXc-Node-7643" class="mjx-mrow"><span id="MJXc-Node-7644" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7645" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7646" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-7647" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">c</span></span><span id="MJXc-Node-7648" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7649" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7650" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7651" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7652" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">n</span></span></span></span><span id="MJXc-Node-7653" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-7654" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-7655" class="mjx-mrow"><span id="MJXc-Node-7656" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7657" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7658" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7659" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7660" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-7661" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">l</span></span></span></span></span></span><span class="mjx-denominator" style="width: 7.99em; bottom: -0.921em;"><span id="MJXc-Node-7662" class="mjx-mrow"><span id="MJXc-Node-7663" class="mjx-texatom"><span id="MJXc-Node-7664" class="mjx-mrow"><span id="MJXc-Node-7665" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7666" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7667" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-7668" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">c</span></span><span id="MJXc-Node-7669" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7670" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-7671" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-7672" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-7673" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">n</span></span></span></span><span id="MJXc-Node-7674" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-7675" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-7676" class="mjx-mrow"><span id="MJXc-Node-7677" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-7678" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-7679" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7680" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-7681" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-7682" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">l</span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.285em; width: 7.99em;" class="mjx-line"></span></span><span style="height: 2.342em; vertical-align: -0.921em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mo>⋅</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-740">
f_1 = 2 \cdot \frac{\mathrm{precision} \cdot \mathrm{rappel}}{\mathrm{precision} + \mathrm{rappel}}
</script></span></p><p>On peut également mesurer le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>2</mn></msub></math>" role="presentation"><span id="MJXc-Node-396" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-397" class="mjx-mrow"><span id="MJXc-Node-398" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-399" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-400" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">f_2</script></span> avec <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi><mo>=</mo><mn>2</mn></math>" role="presentation"><span id="MJXc-Node-401" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-402" class="mjx-mrow"><span id="MJXc-Node-403" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-404" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-405" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>β</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">\beta = 2</script></span>:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>F</mi><mi>&amp;#x03B2;</mi></msub><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><msup><mi>&amp;#x03B2;</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></mrow><mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mi>&amp;#x03B2;</mi><mn>2</mn></msup><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi></mrow></mrow></mfrac></math>" role="presentation"><span id="MJXc-Node-406" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-407" class="mjx-mrow"><span id="MJXc-Node-408" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.106em;"><span id="MJXc-Node-409" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.106em;">F</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span id="MJXc-Node-410" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em; padding-right: 0.007em;">β</span></span></span></span><span id="MJXc-Node-411" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-412" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-413" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span><span id="MJXc-Node-414" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-415" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-416" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0.084em; padding-right: 0.071em;"><span id="MJXc-Node-417" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span><span id="MJXc-Node-418" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-419" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-420" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 10.505em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 10.505em; top: -1.421em;"><span id="MJXc-Node-421" class="mjx-mrow"><span id="MJXc-Node-422" class="mjx-texatom"><span id="MJXc-Node-423" class="mjx-mrow"><span id="MJXc-Node-424" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-425" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-426" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-427" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">c</span></span><span id="MJXc-Node-428" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-429" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-430" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-431" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-432" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">n</span></span></span></span><span id="MJXc-Node-433" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-434" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-435" class="mjx-mrow"><span id="MJXc-Node-436" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-437" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-438" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-439" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-440" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-441" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">l</span></span></span></span></span></span><span class="mjx-denominator" style="width: 10.505em; bottom: -1.035em;"><span id="MJXc-Node-442" class="mjx-mrow"><span id="MJXc-Node-443" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-444" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.007em;"><span id="MJXc-Node-445" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em; padding-right: 0.007em;">β</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.409em; padding-left: 0.084em; padding-right: 0.071em;"><span id="MJXc-Node-446" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span><span id="MJXc-Node-447" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.335em;">⋅</span></span><span id="MJXc-Node-448" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-449" class="mjx-mrow"><span id="MJXc-Node-450" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-451" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-452" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-453" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">c</span></span><span id="MJXc-Node-454" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-455" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">s</span></span><span id="MJXc-Node-456" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">i</span></span><span id="MJXc-Node-457" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">o</span></span><span id="MJXc-Node-458" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">n</span></span></span></span><span id="MJXc-Node-459" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span><span id="MJXc-Node-460" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-461" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-462" class="mjx-mrow"><span id="MJXc-Node-463" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">r</span></span><span id="MJXc-Node-464" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">a</span></span><span id="MJXc-Node-465" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-466" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.556em;">p</span></span><span id="MJXc-Node-467" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">e</span></span><span id="MJXc-Node-468" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">l</span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.285em; width: 10.505em;" class="mjx-line"></span></span><span style="height: 2.456em; vertical-align: -1.035em;" class="mjx-vsize"></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>F</mi><mi>β</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>β</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo>⋅</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></mrow><mrow><mo stretchy="false">(</mo><msup><mi>β</mi><mn>2</mn></msup><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false">)</mo><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi></mrow></mrow></mfrac></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-18">
F_\beta = (1 + \beta^2) \cdot \frac{\mathrm{precision} \cdot \mathrm{rappel}}{(\beta^2 \cdot \mathrm{precision}) + \mathrm{rappel}}
</script></span></p><p>Le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-529-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>2</mn></msub></math>" role="presentation"><span id="MJXc-Node-2726" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2727" class="mjx-mrow"><span id="MJXc-Node-2728" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2729" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2730" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-529">f_2</script></span> permet de favoriser le rappel en sacrifiant un peu de précision et ainsi reconnaître plus de visages au risque de se tromper plus souvent. Cette métrique est intéressante mais le seuil trouvé avec celle-ci sera moins performant au final que celui trouvé avec la métrique <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-530-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-2731" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2732" class="mjx-mrow"><span id="MJXc-Node-2733" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-2734" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-2735" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-530">f_1</script></span></p><p><em>Exemple de résultat</em></p><p><img src="https://i.imgur.com/vmGUgyo.png" alt=""><br>
On voit que l’on obtient un <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-745-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><mn>0.879</mn></math>" role="presentation"><span id="MJXc-Node-7699" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7700" class="mjx-mrow"><span id="MJXc-Node-7701" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7702" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7703" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span><span id="MJXc-Node-7704" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-7705" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.879</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><mn>0.879</mn></math></span></span><script type="math/tex" id="MathJax-Element-745">f_1 = 0.879</script></span> pour un seuil de prédiction à <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-746-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.893</mn></math>" role="presentation"><span id="MJXc-Node-7706" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7707" class="mjx-mrow"><span id="MJXc-Node-7708" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.893</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.893</mn></math></span></span><script type="math/tex" id="MathJax-Element-746">0.893</script></span> (ligne <em>y_pred</em>). Avec ce seuil on voit que l’on a une précision de <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-747-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.845</mn></math>" role="presentation"><span id="MJXc-Node-7709" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7710" class="mjx-mrow"><span id="MJXc-Node-7711" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.845</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.845</mn></math></span></span><script type="math/tex" id="MathJax-Element-747">0.845</script></span> et un rappel de <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-748-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.916</mn></math>" role="presentation"><span id="MJXc-Node-7712" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7713" class="mjx-mrow"><span id="MJXc-Node-7714" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.916</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.916</mn></math></span></span><script type="math/tex" id="MathJax-Element-748">0.916</script></span> ce qui signifie que l’on trouve 91% des visages et que si le modèle prédit un visage il a raison dans 84% des cas.</p><p>On peut s’intéresser au <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>2</mn></msub></math>" role="presentation"><span id="MJXc-Node-495" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-496" class="mjx-mrow"><span id="MJXc-Node-497" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-498" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-499" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">f_2</script></span>, on voit que le score est plus élevé et que le seuil de prédiction est plus bas <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.711</mn></math>" role="presentation"><span id="MJXc-Node-500" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-501" class="mjx-mrow"><span id="MJXc-Node-502" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.711</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.711</mn></math></span></span><script type="math/tex" id="MathJax-Element-26">0.711</script></span> mais on peut aussi voir que la précision est déscendue à <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.784</mn></math>" role="presentation"><span id="MJXc-Node-503" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-504" class="mjx-mrow"><span id="MJXc-Node-505" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.784</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.784</mn></math></span></span><script type="math/tex" id="MathJax-Element-27">0.784</script></span> ce qui est trop bas pour notre utilisation. En effet on ne veut pas que notre modèle signale trop de visage là où il n’y en a pas.<br>
<img src="https://i.imgur.com/1gga9gG.png" alt=""></p><h3 id="Résultats"><a class="anchor hidden-xs" href="#Résultats" title="Résultats"><span class="octicon octicon-link"></span></a>Résultats</h3><p>Après avoir entraîné le modèle pendant 100 époques pour une durée totale d’environ 4 heures on obtient les courbes suivantes :</p><p><img src="https://i.imgur.com/bu37eCF.png" alt=""></p><p><img src="https://i.imgur.com/BhClNBU.png" alt=""></p><p><img src="https://i.imgur.com/2yKv4YV.png" alt=""></p><p><img src="https://i.imgur.com/ZU48QQZ.png" alt=""></p><p><img src="https://i.imgur.com/y6fd9tB.png" alt=""></p><p>Le modèle qui a montré les meilleurs résultats est celui de l’époque 47 avec un bon compromis <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-749-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7715" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7716" class="mjx-mrow"><span id="MJXc-Node-7717" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7718" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7719" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-749">f_1</script></span> de <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-750-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.873</mn></math>" role="presentation"><span id="MJXc-Node-7720" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7721" class="mjx-mrow"><span id="MJXc-Node-7722" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.873</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.873</mn></math></span></span><script type="math/tex" id="MathJax-Element-750">0.873</script></span> et <em>validation loss</em> de <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-751-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.0766</mn></math>" role="presentation"><span id="MJXc-Node-7723" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7724" class="mjx-mrow"><span id="MJXc-Node-7725" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.0766</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.0766</mn></math></span></span><script type="math/tex" id="MathJax-Element-751">0.0766</script></span>.</p><p>Le modèle de l’époque 74 avait un meilleur <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-293-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-1561" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1562" class="mjx-mrow"><span id="MJXc-Node-1563" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-1564" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1565" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-293">f_1</script></span> de <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-294-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.879</mn></math>" role="presentation"><span id="MJXc-Node-1566" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1567" class="mjx-mrow"><span id="MJXc-Node-1568" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.879</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.879</mn></math></span></span><script type="math/tex" id="MathJax-Element-294">0.879</script></span> mais la <em>validation loss</em> a légèrement remonté (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-295-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.1061</mn></math>" role="presentation"><span id="MJXc-Node-1569" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1570" class="mjx-mrow"><span id="MJXc-Node-1571" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.1061</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.1061</mn></math></span></span><script type="math/tex" id="MathJax-Element-295">0.1061</script></span>) ce qui indique un léger <em>overfitting</em>.</p><h2 id="Prédiction"><a class="anchor hidden-xs" href="#Prédiction" title="Prédiction"><span class="octicon octicon-link"></span></a>Prédiction</h2><p>Maintenant que notre modèle est entraîné et peut reconnaître des visages sur des imagess en 32x32 nous pouvons appliquer notre algorithme de <em>sliding window</em> cette fois pour faire des prédictions.</p><h3 id="Calibrage-de-la-détection"><a class="anchor hidden-xs" href="#Calibrage-de-la-détection" title="Calibrage-de-la-détection"><span class="octicon octicon-link"></span></a>Calibrage de la détection</h3><h4 id="Paramètres-utilisés"><a class="anchor hidden-xs" href="#Paramètres-utilisés" title="Paramètres-utilisés"><span class="octicon octicon-link"></span></a>Paramètres utilisés</h4><p>Pour déterminer les paramètres de détection nous allons utiliser les paramètres que nous avons utilisé pour le découpage qui a servi à créer le dataset car c’est avec cela que notre modèle s’est entrâiné :</p><ul>
<li>Taille de fenêtres :
<ul>
<li>(100, 85)</li>
<li>(200, 100)</li>
<li>(250, 212)</li>
</ul>
</li>
<li>Stride : 35</li>
</ul><h4 id="Seuil-de-détection"><a class="anchor hidden-xs" href="#Seuil-de-détection" title="Seuil-de-détection"><span class="octicon octicon-link"></span></a>Seuil de détection</h4><p>Pour déterminer le seuil de détection optimal il faudrait prédire toutes les boîtes possible puis les trier par score et calculer le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-506" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-507" class="mjx-mrow"><span id="MJXc-Node-508" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-510" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">f_1</script></span> pour chaque score unique afin de trouver quel seuil maximise sa valeur.</p><p>Faire cette opération est très gourmand en ressources et nécessite beaucoup de temps. C’est pourquoi nous allons utiliser le seuil trouvé précédemment qui maximise la détéction sur l’ensemble de validation lors de l’entraînement du modèle. On utilise le score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-797-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7831" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7832" class="mjx-mrow"><span id="MJXc-Node-7833" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7834" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7835" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-797">f_1</script></span> de notre modèle en validation comme un proxy et on assume que le seuil maximisant le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-798-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7836" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7837" class="mjx-mrow"><span id="MJXc-Node-7838" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7839" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7840" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-798">f_1</script></span> en validation, maximisera le <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-799-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7841" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7842" class="mjx-mrow"><span id="MJXc-Node-7843" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7844" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7845" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-799">f_1</script></span> lors de la prédiction.</p><h4 id="Sélection-des-boîtes"><a class="anchor hidden-xs" href="#Sélection-des-boîtes" title="Sélection-des-boîtes"><span class="octicon octicon-link"></span></a>Sélection des boîtes</h4><p>Notre algorithme va calculer un ensemble de boîtes dans lesquelles il estime voir un visage. Nous allons inévitablement nous retrouver avec plusieurs boîtes par visage. Une idée serait de garder uniquement la boîte ayant le meilleur score pour chaque visage. Cependant, lors de l’entraînement, il a été décidé que les boîtes ayant un recouvrement IOU supérieur à 0.4 avec une boîte label seraient considérées comme positives. Notre modèle va donc avoir tendance à détecter des boîtes légèrement décalées.</p><p>On va donc appliquer une technique de fusion des boîtes, en effet notre modèle détecte des boîtes de différentes taille autour du visage avec une forte concentration vers le centre du visage. Faire la moyenne des coordonnées de toute ces boîtes est la méthode qui a montré les meilleurs résultats sur l’ensemble de validation et celle que l’on va garder.</p><p>De plus pour savoir quelles boîtes fusionner entre elle, on commence par uniquement regarder les boîtes les plus petites qui ne se recouvrent pas, puis on va les fusionner avec les boîtes de plus en plus grande jusqu’à en dégager des groupes de boîtes qui correspondent chacun à un visage.</p><p>Enfin une fois les boîtes fusionnées, on refait une prédiction sur les images en les découpant avec les coordonnées de ces boîtes afin de vérifier que notre score de prédiction est toujours au dessus du seuil précédemment défini, sinon on supprimme la boîte.</p><h4 id="Calcul-du-score-f_1"><a class="anchor hidden-xs" href="#Calcul-du-score-f_1" title="Calcul-du-score-f_1"><span class="octicon octicon-link"></span></a>Calcul du score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-526" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-527" class="mjx-mrow"><span id="MJXc-Node-528" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-529" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-530" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">f_1</script></span></h4><p>Il nous faut pouvoir calculer le score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-805-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7871" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7872" class="mjx-mrow"><span id="MJXc-Node-7873" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7874" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7875" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-805">f_1</script></span> des prédictions de notre modèle. On rappelle qu’une boîte est considérée comme vrai positif si elle recouvre une boîte label avec un IOU d’au moins 0.5. Il ne doit y avoir qu’une seule détection par boîte label et si un visage est detecté plusieurs fois, les détections supplémentaires seront considérées comme faux positifs. Enfin un visage non détecté sera considéré comme faux négatif.</p><p>Pour avoir une idée de nos performances nous allons faire des prédictions sur l’ensemble de validation afin de pouvoir estimer notre score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-536" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-537" class="mjx-mrow"><span id="MJXc-Node-538" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-540" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">f_1</script></span> potentiel sur l’ensemble de test.</p><p>Après avoir essayé différents paramètres de taille de fenêtre, de stride et de fusion de boîtes prédite, il s’avère que les paramètres donnant les meilleurs résultats sont les suivants :</p><ul>
<li>Taille de fenêtres :
<ul>
<li>(100, 85)</li>
<li>(200, 100)</li>
<li>(250, 212)</li>
</ul>
</li>
<li>Stride : 30</li>
<li>Méthode de fusion des boîtes : moyenne des coordonnées</li>
</ul><p>On voit que le stride a été diminué à 30 ce qui permet d’avoir un pas plus petit. En effet lors de l’entraînement on a choisi un pas de 35 pour ne pas généré trop d’images d’apprentissages mais pour la détection un pas de 30 n’augmente pas significativement de temps de prédiction et apporte un boost au score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-807-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-7881" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7882" class="mjx-mrow"><span id="MJXc-Node-7883" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-7884" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-7885" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-807">f_1</script></span>.</p><h3 id="Performances-de-détection"><a class="anchor hidden-xs" href="#Performances-de-détection" title="Performances-de-détection"><span class="octicon octicon-link"></span></a>Performances de détection</h3><p>Le score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-541" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-542" class="mjx-mrow"><span id="MJXc-Node-543" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-544" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-545" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">f_1</script></span> trouvé en utilisant les paramètres optimaux précédemment défini sur l’ensemble de validation est un bon estimateur du score <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 113%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-546" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-547" class="mjx-mrow"><span id="MJXc-Node-548" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.501em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-550" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-36">f_1</script></span> final que l’on obtiendra sur l’ensemble de test.</p><p>On a obtenu sur l’ensemble de validation un score autour de 0.94 ce qui a donné sur l’ensemble de test un score exact de 0.9561.</p><p>Le temps pour réaliser la détection est relativement rapide avec environ 3 minutes pour faire une détection sur les 500 images de test.</p><p><img src="https://i.imgur.com/4zGe78U.png" alt=""></p><h1 id="Conclusions"><a class="anchor hidden-xs" href="#Conclusions" title="Conclusions"><span class="octicon octicon-link"></span></a>Conclusions</h1><p>L’objectif de ce projet a été atteint, il s’agissait de développer un détecteur de visages sur des images de différentes tailles. Il a fallu être astucieux dans la création des jeux de données d’entraînement et validation en utilisant seulement les 1000 images à notre disposition afin d’en tirer le meilleur parti. Au final on a obtenu un modèle relativement robuste, qui peut détecter un visage plus ou moins gros et ne détecte pas de visages par exemple dans le paysage ou dans du texte. Une des faiblesse actuelle du modèle est qu’il ne reconnaît pas les visages plus petits, il faudrait donc ajouter une taille de fenêtre plus petite mais cela implique beaucoup plus de temps d’entraînement et de temps de prédiction.</p><p>Il reste encore beaucoup de possibilités pour améliorer notre détecteur, on pourrait chercher à calculer les paramètres donnant les meilleurs résultats durant l’application de la <em>sliding window</em>. On pourrait tenter d’utiliser d’autres paramètres de génération du dataset pour apprendre à notre modèle à être plus précis ou mieux centré sur les visages.</p><p>On pourrait également explorer d’autres approches comme par exemple prendre en entrée l’image entière et directement prédire les coordonnées des boîtes.</p><h1 id="Instructions"><a class="anchor hidden-xs" href="#Instructions" title="Instructions"><span class="octicon octicon-link"></span></a>Instructions</h1><div class="alert alert-info">
<p>python 3.7.5<br>
tensorflow 2.0.0<br>
tensorflow-gpu 2.0.0<br>
numpy 1.18.1<br>
pandas 1.0.3<br>
pillow 7.1.1<br>
keras-gpu 2.3.1</p>
</div><table>
<thead>
<tr>
<th>Fichier</th>
<th>fonction</th>
</tr>
</thead>
<tbody>
<tr>
<td>create_dataset</td>
<td>Crée le découpage et sauvegarde le dataset dans un dossier train32x32 (multiprocessing)</td>
</tr>
<tr>
<td>find_params</td>
<td>Calcule les performances maximale de certains paramètres de découpage (multiprocessing)</td>
</tr>
<tr>
<td>callback</td>
<td>Custom Keras Callback pour calcul du <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-891-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 96%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mn>1</mn></msub></math>" role="presentation"><span id="MJXc-Node-8301" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-8302" class="mjx-mrow"><span id="MJXc-Node-8303" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.06em;"><span id="MJXc-Node-8304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.459em; padding-bottom: 0.459em; padding-right: 0.06em;">f</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-8305" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.394em; padding-bottom: 0.329em;">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-891">f_1</script></span> à la fin de chaque époque</td>
</tr>
<tr>
<td>model</td>
<td>Modèle Keras utilisé pour l’entraînement et la prédiction</td>
</tr>
<tr>
<td>util</td>
<td>Ensemble de fonctions utilitaires</td>
</tr>
<tr>
<td>visage_detector</td>
<td>Classe qui effectue la détection</td>
</tr>
<tr>
<td>train</td>
<td>Lance l’entraînement</td>
</tr>
<tr>
<td>test</td>
<td>Lance la détection et génère le fichier sub.txt</td>
</tr>
</tbody>
</table><p>Pour créer le dataset d’entraînement il faut lancer le fichier <em>create_dataset.py</em>. On peut ensuite lancer l’entraînement avec le fichier <em><a href="http://train.py" target="_blank" rel="noopener">train.py</a></em></p><div class="alert alert-danger">
<p>L’entraînement peut prendre beaucoup de temps selon la configuration.<br>
~4h avec GTX 1060 6Go</p>
</div><p>Utiliser <em><a href="http://test.py" target="_blank" rel="noopener">test.py</a></em> pour faire la prédiction</p><h1 id="Références"><a class="anchor hidden-xs" href="#Références" title="Références"><span class="octicon octicon-link"></span></a>Références</h1><p><a href="https://arxiv.org/abs/1409.1556" target="_blank" rel="noopener">[1]</a> Very Deep Convolutional Networks for Large-Scale Image Recognition by Karen Simonyan, Andrew Zisserman</p><p><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7486599&amp;tag=1" target="_blank" rel="noopener">[2]</a> Very Deep Convolutional Neural Network Based Image Classification UsingSmall Training Sample Size by Shuying Liu, Weihong Deng</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#SY32---Analyse-et-synthèse-d’images---Détection-de-visages" title="SY32 - Analyse et synthèse d’images - Détection de visages">SY32 - Analyse et synthèse d’images - Détection de visages</a></li>
<li><a href="#Introduction" title="Introduction">Introduction</a></li>
<li><a href="#Choix-d’implémentation" title="Choix d’implémentation">Choix d’implémentation</a><ul class="nav">
<li><a href="#Résumé" title="Résumé">Résumé</a></li>
<li><a href="#Choix-du-modèle" title="Choix du modèle">Choix du modèle</a></li>
<li><a href="#Plan-d’action" title="Plan d’action">Plan d’action</a></li>
<li><a href="#Analyse-des-données" title="Analyse des données">Analyse des données</a></li>
<li><a href="#Déterminer-les-paramètres-optimaux-de-l’algorithme-sliding-window-et-création-du-dataset" title="Déterminer les paramètres optimaux de l’algorithme sliding window et création du dataset">Déterminer les paramètres optimaux de l’algorithme sliding window et création du dataset</a><ul class="nav">
<li><a href="#Algorithme-sliding-window" title="Algorithme sliding window">Algorithme sliding window</a></li>
<li><a href="#Déterminer-les-paramètres-optimaux" title="Déterminer les paramètres optimaux">Déterminer les paramètres optimaux</a></li>
<li><a href="#Création-du-dataset" title="Création du dataset">Création du dataset</a></li>
</ul>
</li>
<li><a href="#Architecture-du-CNN" title="Architecture du CNN">Architecture du CNN</a></li>
<li><a href="#Entraînement-du-modèle" title="Entraînement du modèle">Entraînement du modèle</a><ul class="nav">
<li><a href="#Gestion-du-déséquilibre-des-données" title="Gestion du déséquilibre des données">Gestion du déséquilibre des données</a></li>
<li><a href="#Mesures-des-performances" title="Mesures des performances">Mesures des performances</a></li>
<li><a href="#Résultats" title="Résultats">Résultats</a></li>
</ul>
</li>
<li><a href="#Prédiction" title="Prédiction">Prédiction</a><ul class="nav">
<li><a href="#Calibrage-de-la-détection" title="Calibrage de la détection">Calibrage de la détection</a></li>
<li><a href="#Performances-de-détection" title="Performances de détection">Performances de détection</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#Conclusions" title="Conclusions">Conclusions</a></li>
<li class=""><a href="#Instructions" title="Instructions">Instructions</a></li>
<li class=""><a href="#Références" title="Références">Références</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#SY32---Analyse-et-synthèse-d’images---Détection-de-visages" title="SY32 - Analyse et synthèse d’images - Détection de visages">SY32 - Analyse et synthèse d’images - Détection de visages</a></li>
<li><a href="#Introduction" title="Introduction">Introduction</a></li>
<li><a href="#Choix-d’implémentation" title="Choix d’implémentation">Choix d’implémentation</a><ul class="nav">
<li><a href="#Résumé" title="Résumé">Résumé</a></li>
<li><a href="#Choix-du-modèle" title="Choix du modèle">Choix du modèle</a></li>
<li><a href="#Plan-d’action" title="Plan d’action">Plan d’action</a></li>
<li><a href="#Analyse-des-données" title="Analyse des données">Analyse des données</a></li>
<li><a href="#Déterminer-les-paramètres-optimaux-de-l’algorithme-sliding-window-et-création-du-dataset" title="Déterminer les paramètres optimaux de l’algorithme sliding window et création du dataset">Déterminer les paramètres optimaux de l’algorithme sliding window et création du dataset</a><ul class="nav">
<li><a href="#Algorithme-sliding-window" title="Algorithme sliding window">Algorithme sliding window</a></li>
<li><a href="#Déterminer-les-paramètres-optimaux" title="Déterminer les paramètres optimaux">Déterminer les paramètres optimaux</a></li>
<li><a href="#Création-du-dataset" title="Création du dataset">Création du dataset</a></li>
</ul>
</li>
<li><a href="#Architecture-du-CNN" title="Architecture du CNN">Architecture du CNN</a></li>
<li><a href="#Entraînement-du-modèle" title="Entraînement du modèle">Entraînement du modèle</a><ul class="nav">
<li><a href="#Gestion-du-déséquilibre-des-données" title="Gestion du déséquilibre des données">Gestion du déséquilibre des données</a></li>
<li><a href="#Mesures-des-performances" title="Mesures des performances">Mesures des performances</a></li>
<li><a href="#Résultats" title="Résultats">Résultats</a></li>
</ul>
</li>
<li><a href="#Prédiction" title="Prédiction">Prédiction</a><ul class="nav">
<li><a href="#Calibrage-de-la-détection" title="Calibrage de la détection">Calibrage de la détection</a></li>
<li><a href="#Performances-de-détection" title="Performances de détection">Performances de détection</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#Conclusions" title="Conclusions">Conclusions</a></li>
<li class=""><a href="#Instructions" title="Instructions">Instructions</a></li>
<li class=""><a href="#Références" title="Références">Références</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
